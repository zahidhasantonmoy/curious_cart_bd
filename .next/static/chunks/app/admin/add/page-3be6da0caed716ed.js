(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[431],{7261:function(e,t,a){Promise.resolve().then(a.bind(a,4498))},6463:function(e,t,a){"use strict";var r=a(1169);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},4498:function(e,t,a){"use strict";var r=a(7437),s=a(2265),l=a(6463);t.default=e=>{let{product:t}=e,[a,i]=(0,s.useState)({name:"",description:"",price:0,image:"",category:"",stock:0}),[o,d]=(0,s.useState)(null),[n,m]=(0,s.useState)([]),c=(0,l.useRouter)();(0,s.useEffect)(()=>{t&&(i(t),m(t.variants||[]))},[t]);let u=e=>{let{name:t,value:a}=e.target;i(e=>({...e,[t]:a}))},g=(e,t,a)=>{let r=[...n];r[e][t]=a,m(r)},x=e=>{m(t=>t.filter((t,a)=>a!==e))},f=async e=>{e.preventDefault();let r=a.image;if(o){let e=new FormData;e.append("file",o);let t=await fetch("/api/upload",{method:"POST",body:e});if(t.ok)r=(await t.json()).url;else{alert("Image upload failed.");return}}let s=t?"/api/products/".concat(t.id):"/api/products",l=t?"PUT":"POST";(await fetch(s,{method:l,headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,image:r,variants:n})})).ok&&c.push("/admin")};return(0,r.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,r.jsx)("input",{type:"text",name:"name",id:"name",value:a.name,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{name:"description",id:"description",value:a.description,onChange:u,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Price"}),(0,r.jsx)("input",{type:"number",name:"price",id:"price",value:a.price,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700",children:"Stock"}),(0,r.jsx)("input",{type:"number",name:"stock",id:"stock",value:a.stock,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,r.jsx)("input",{type:"text",name:"category",id:"category",value:a.category,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"currentImage",className:"block text-sm font-medium text-gray-700",children:"Current Image URL"}),(0,r.jsx)("input",{type:"text",name:"image",id:"currentImage",value:a.image,onChange:u,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"imageUpload",className:"block text-sm font-medium text-gray-700",children:"Upload New Image"}),(0,r.jsx)("input",{type:"file",name:"imageUpload",id:"imageUpload",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&d(e.target.files[0])},className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),(0,r.jsxs)("div",{className:"border p-4 rounded-md",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Product Variants"}),n.map((e,t)=>(0,r.jsxs)("div",{className:"flex space-x-2 mb-2 items-end",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("label",{htmlFor:"variant-type-".concat(t),className:"block text-sm font-medium text-gray-700",children:"Type"}),(0,r.jsx)("input",{type:"text",id:"variant-type-".concat(t),value:e.type,onChange:e=>g(t,"type",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm sm:text-sm",placeholder:"e.g., Size, Color"})]}),(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("label",{htmlFor:"variant-value-".concat(t),className:"block text-sm font-medium text-gray-700",children:"Value"}),(0,r.jsx)("input",{type:"text",id:"variant-value-".concat(t),value:e.value,onChange:e=>g(t,"value",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm sm:text-sm",placeholder:"e.g., Small, Blue"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"variant-modifier-".concat(t),className:"block text-sm font-medium text-gray-700",children:"Price Modifier"}),(0,r.jsx)("input",{type:"number",id:"variant-modifier-".concat(t),value:e.price_modifier,onChange:e=>g(t,"price_modifier",parseFloat(e.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm sm:text-sm",placeholder:"e.g., 5.00"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>x(t),className:"bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600",children:"Remove"})]},t)),(0,r.jsx)("button",{type:"button",onClick:()=>{m(e=>[...e,{type:"",value:"",price_modifier:0}])},className:"mt-2 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Add Variant"})]}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600",children:t?"Update Product":"Add Product"})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=7261)}),_N_E=e.O()}]);